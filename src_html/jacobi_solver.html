<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="main_style.css">
  <title>WebAssembly Numerical Computing: Jacobi Solver</title>

</head>

<body>

  <main>

    <div class="description">
      <h1>WebAssembly Numerical Computing: Jacobi Solver</h1>
      <p>
          This page measures the performance of the Jacobi solver with 10 iterations.
      </p>

      <p>
          The numbers below are in milliseconds.
          The time is sampled by <code>chrono::high_resolution_clock::now()</code>.
          Please note that the resolution of the function in most of the browsers is around <i>100 [μs]</i>,
          and therefore the value <i>0</i> below should be interpreted as somewhere between <i>0</i> and <i>100 [μs]</i>.
      </p>

    </div>

    <div>

      <h2>Results for Float, Column-Major</h2>

      <h3>Results from This Browser</h3>    
      <table id="results_browser_float_colmajor" border="1">
      <th>Calculating...</th>
      </table>

      <h3 class="results_native">[Reference] Results from Mac Mini M1 2020 Native in C++</h3>
      <table class="results_native" border="1">

        <tr><th>matrix size</th><th>64x64</th><th>128x128</th><th>256x256</th><th>512x512</th><th>1Kx1K</th></tr>
        <tr><td>plain c++</td><td>0.104258</td><td>0.39385</td><td>1.13728</td><td>2.81615</td><td>12.2516</td></tr>
        <tr><td>NEON loop unrolled order 1</td><td>0.0246375</td><td>0.0750043</td><td>0.215988</td><td>0.548837</td><td>2.52052</td></tr>
        <tr><td>NEON loop unrolled order 2</td><td>0.0149251</td><td>0.0451583</td><td>0.117054</td><td>0.296112</td><td>1.31597</td></tr>
        <tr><td>NEON loop unrolled order 4</td><td>0.0090958</td><td>0.0280041</td><td>0.0727209</td><td>0.176896</td><td>0.853154</td></tr>
        <tr><td>NEON loop unrolled order 8</td><td>0.0091417</td><td>0.0228208</td><td>0.0649666</td><td>0.158829</td><td>0.7312</td></tr>

      </table>

    </div>

    <div>

      <h2>Results for Float, Row-Major</h2>

      <h3>Results from This Browser</h3>    
      <table id="results_browser_float_rowmajor" border="1">
      <th>Calculating...</th>
      </table>

      <h3 class="results_native">[Reference] Results from Mac Mini M1 2020 Native in C++</h3>
      <table class="results_native" border="1">

        <tr><th>matrix size</th><th>64x64</th><th>128x128</th><th>256x256</th><th>512x512</th><th>1Kx1K</th></tr>
        <tr><td>plain c++</td><td>0.0132414</td><td>0.0725165</td><td>0.345662</td><td>1.83852</td><td>8.58803</td></tr>
        <tr><td>NEON loop unrolled order 1</td><td>0.0039833</td><td>0.0165749</td><td>0.0813376</td><td>0.398679</td><td>1.87648</td></tr>
        <tr><td>NEON loop unrolled order 2</td><td>0.0035958</td><td>0.0123834</td><td>0.0544374</td><td>0.231454</td><td>0.976805</td></tr>
        <tr><td>NEON loop unrolled order 4</td><td>0.004125</td><td>0.0130417</td><td>0.0525542</td><td>0.202792</td><td>0.805383</td></tr>
        <tr><td>NEON loop unrolled order 8</td><td>0.0071459</td><td>0.0203253</td><td>0.0673377</td><td>0.245029</td><td>0.861617</td></tr>

      </table>

    </div>

    <div>

      <h2>Results for Double, Column-Major</h2>

      <h3>Results from This Browser</h3>    
      <table id="results_browser_double_colmajor" border="1">
      <th>Calculating...</th>
      </table>

      <h3 class="results_native">[Reference] Results from Mac Mini M1 2020 Native in C++</h3>
      <table class="results_native" border="1">

        <tr><th>matrix size</th><th>64x64</th><th>128x128</th><th>256x256</th><th>512x512</th><th>1Kx1K</th></tr>
        <tr><td>plain c++</td><td>0.0222833</td><td>0.123546</td><td>0.594179</td><td>2.82677</td><td>12.8458</td></tr>
        <tr><td>NEON loop unrolled order 1</td><td>0.0098709</td><td>0.0504501</td><td>0.2468</td><td>1.1691</td><td>5.8635</td></tr>
        <tr><td>NEON loop unrolled order 2</td><td>0.0067499</td><td>0.0312586</td><td>0.142454</td><td>0.623429</td><td>3.35215</td></tr>
        <tr><td>NEON loop unrolled order 4</td><td>0.0042458</td><td>0.0192251</td><td>0.0904292</td><td>0.377013</td><td>2.32346</td></tr>
        <tr><td>NEON loop unrolled order 8</td><td>0.0036667</td><td>0.015725</td><td>0.0802876</td><td>0.345117</td><td>1.78883</td></tr>
        
      </table>

    </div>

    <div>

      <h2>Results for Double, Row-Major</h2>

      <h3>Results from This Browser</h3>    
      <table id="results_browser_double_rowmajor" border="1">
      <th>Calculating...</th>
      </table>

      <h3 class="results_native">[Reference] Results from Mac Mini M1 2020 Native in C++</h3>
      <table class="results_native" border="1">

        <tr><th>matrix size</th><th>64x64</th><th>128x128</th><th>256x256</th><th>512x512</th><th>1Kx1K</th></tr>
        <tr><td>plain c++</td><td>0.0155748</td><td>0.084746</td><td>0.351675</td><td>1.92024</td><td>8.8248</td></tr>
        <tr><td>NEON loop unrolled order 1</td><td>0.0080082</td><td>0.0421999</td><td>0.199142</td><td>0.926813</td><td>4.41145</td></tr>
        <tr><td>NEON loop unrolled order 2</td><td>0.0059876</td><td>0.0246541</td><td>0.111783</td><td>0.471679</td><td>2.23293</td></tr>
        <tr><td>NEON loop unrolled order 4</td><td>0.0051458</td><td>0.0210082</td><td>0.100142</td><td>0.396925</td><td>1.66697</td></tr>
        <tr><td>NEON loop unrolled order 8</td><td>0.0067167</td><td>0.0239498</td><td>0.101287</td><td>0.388479</td><td>1.62935</td></tr>


      </table>

    </div>

  </main>

  <script>
    let Module = {
      onRuntimeInitialized: () => {

        let resultFloatColMajor = Module.testJacobiSolverFloatColMajor();
        console.log( resultFloatColMajor );
        
        let tableFloatColMajor = document.querySelector('#results_browser_float_colmajor');
        tableFloatColMajor.innerHTML = resultFloatColMajor;

        let resultFloatRowMajor = Module.testJacobiSolverFloatRowMajor();
        console.log( resultFloatRowMajor );
        
        let tableFloatRowMajor = document.querySelector('#results_browser_float_rowmajor');
        tableFloatRowMajor.innerHTML = resultFloatRowMajor;

        let resultDoubleColMajor = Module.testJacobiSolverDoubleColMajor();
        console.log( resultDoubleColMajor );
        
        let tableDoubleColMajor = document.querySelector('#results_browser_double_colmajor');
        tableDoubleColMajor.innerHTML = resultDoubleColMajor;

        let resultDoubleRowMajor = Module.testJacobiSolverDoubleRowMajor();
        console.log( resultDoubleRowMajor );
        
        let tableDoubleRowMajor = document.querySelector('#results_browser_double_rowmajor');
        tableDoubleRowMajor.innerHTML = resultDoubleRowMajor;

      }
    };
  </script>
  <script src="jacobi_solver.js"></script>
</body>

</html>
