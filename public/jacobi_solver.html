<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="main_style.css">
  <title>WebAssembly Numerical Computing: Jacobi Solver</title>

</head>

<body>

  <main>

    <div class="description">
      <h1>WebAssembly Numerical Computing: Jacobi Solver</h1>
      <p>
          This page measures the performance of the Jacobi solver with 10 iterations.
      </p>

      <p>
        The numbers in the tables show the time taken to perform the operation in milliseconds.
        The time is sampled by <code>chrono::high_resolution_clock::now()</code> in C++.
        Please note that the resolution of this function in most of the browsers is around <i>0.01</i>[ms].
      </p>

    </div>

    <div>

      <h2>Results for Float, Column-Major</h2>

      <h3>Results from This Browser</h3>    
      <table id="results_browser_float_colmajor" border="1">
      <th>Calculating...</th>
      </table>

      <h3 class="results_native">[Reference] Results from Mac Mini M1 2020 Native in C++</h3>
      <table class="results_native" border="1">

        <tr><th>matrix size</th><th>64x64</th><th>128x128</th><th>256x256</th><th>512x512</th><th>1Kx1K</th></tr>
        <tr><td>plain c++</td><td>0.0414</td><td>0.224</td><td>0.829</td><td>2.82</td><td>12.3</td></tr>
        <tr><td>NEON loop unrolled order 1</td><td>0.0109</td><td>0.0493</td><td>0.167</td><td>0.55</td><td>2.45</td></tr>
        <tr><td>NEON loop unrolled order 2</td><td>0.00644</td><td>0.0276</td><td>0.0957</td><td>0.296</td><td>1.3</td></tr>
        <tr><td>NEON loop unrolled order 4</td><td>0.00418</td><td>0.0171</td><td>0.055</td><td>0.177</td><td>0.846</td></tr>
        <tr><td>NEON loop unrolled order 8</td><td>0.00393</td><td>0.014</td><td>0.0491</td><td>0.158</td><td>0.728</td></tr>
        
      </table>

    </div>

    <div>

      <h2>Results for Float, Row-Major</h2>

      <h3>Results from This Browser</h3>    
      <table id="results_browser_float_rowmajor" border="1">
      <th>Calculating...</th>
      </table>

      <h3 class="results_native">[Reference] Results from Mac Mini M1 2020 Native in C++</h3>
      <table class="results_native" border="1">

        <tr><th>matrix size</th><th>64x64</th><th>128x128</th><th>256x256</th><th>512x512</th><th>1Kx1K</th></tr>
        <tr><td>plain c++</td><td>0.0131</td><td>0.0732</td><td>0.346</td><td>1.84</td><td>8.58</td></tr>
        <tr><td>NEON loop unrolled order 1</td><td>0.00399</td><td>0.0165</td><td>0.0813</td><td>0.4</td><td>1.87</td></tr>
        <tr><td>NEON loop unrolled order 2</td><td>0.0036</td><td>0.0124</td><td>0.0545</td><td>0.232</td><td>0.977</td></tr>
        <tr><td>NEON loop unrolled order 4</td><td>0.00413</td><td>0.013</td><td>0.0545</td><td>0.204</td><td>0.803</td></tr>
        <tr><td>NEON loop unrolled order 8</td><td>0.00713</td><td>0.0203</td><td>0.0673</td><td>0.245</td><td>0.861</td></tr>
        
      </table>

    </div>

    <div>

      <h2>Results for Double, Column-Major</h2>

      <h3>Results from This Browser</h3>    
      <table id="results_browser_double_colmajor" border="1">
      <th>Calculating...</th>
      </table>

      <h3 class="results_native">[Reference] Results from Mac Mini M1 2020 Native in C++</h3>
      <table class="results_native" border="1">

        <tr><th>matrix size</th><th>64x64</th><th>128x128</th><th>256x256</th><th>512x512</th><th>1Kx1K</th></tr>
        <tr><td>plain c++</td><td>0.0223</td><td>0.124</td><td>0.597</td><td>2.83</td><td>12.9</td></tr>
        <tr><td>NEON loop unrolled order 1</td><td>0.00989</td><td>0.0519</td><td>0.248</td><td>1.18</td><td>5.62</td></tr>
        <tr><td>NEON loop unrolled order 2</td><td>0.00677</td><td>0.0316</td><td>0.142</td><td>0.624</td><td>3.24</td></tr>
        <tr><td>NEON loop unrolled order 4</td><td>0.00423</td><td>0.0193</td><td>0.091</td><td>0.377</td><td>2.09</td></tr>
        <tr><td>NEON loop unrolled order 8</td><td>0.00365</td><td>0.016</td><td>0.0797</td><td>0.344</td><td>1.7</td></tr>
                
      </table>

    </div>

    <div>

      <h2>Results for Double, Row-Major</h2>

      <h3>Results from This Browser</h3>    
      <table id="results_browser_double_rowmajor" border="1">
      <th>Calculating...</th>
      </table>

      <h3 class="results_native">[Reference] Results from Mac Mini M1 2020 Native in C++</h3>
      <table class="results_native" border="1">

        <tr><th>matrix size</th><th>64x64</th><th>128x128</th><th>256x256</th><th>512x512</th><th>1Kx1K</th></tr>
        <tr><td>plain c++</td><td>0.0155</td><td>0.0841</td><td>0.353</td><td>1.92</td><td>8.8</td></tr>
        <tr><td>NEON loop unrolled order 1</td><td>0.00791</td><td>0.0413</td><td>0.201</td><td>0.93</td><td>4.38</td></tr>
        <tr><td>NEON loop unrolled order 2</td><td>0.00593</td><td>0.0246</td><td>0.11</td><td>0.472</td><td>2.22</td></tr>
        <tr><td>NEON loop unrolled order 4</td><td>0.00495</td><td>0.0217</td><td>0.1</td><td>0.4</td><td>1.65</td></tr>
        <tr><td>NEON loop unrolled order 8</td><td>0.00733</td><td>0.024</td><td>0.0994</td><td>0.391</td><td>1.62</td></tr>
        
      </table>

    </div>

  </main>

  <script>
    let Module = {
      onRuntimeInitialized: () => {

        let resultFloatColMajor = Module.testJacobiSolverFloatColMajor();
        console.log( resultFloatColMajor );
        
        let tableFloatColMajor = document.querySelector('#results_browser_float_colmajor');
        tableFloatColMajor.innerHTML = resultFloatColMajor;

        let resultFloatRowMajor = Module.testJacobiSolverFloatRowMajor();
        console.log( resultFloatRowMajor );
        
        let tableFloatRowMajor = document.querySelector('#results_browser_float_rowmajor');
        tableFloatRowMajor.innerHTML = resultFloatRowMajor;

        let resultDoubleColMajor = Module.testJacobiSolverDoubleColMajor();
        console.log( resultDoubleColMajor );
        
        let tableDoubleColMajor = document.querySelector('#results_browser_double_colmajor');
        tableDoubleColMajor.innerHTML = resultDoubleColMajor;

        let resultDoubleRowMajor = Module.testJacobiSolverDoubleRowMajor();
        console.log( resultDoubleRowMajor );
        
        let tableDoubleRowMajor = document.querySelector('#results_browser_double_rowmajor');
        tableDoubleRowMajor.innerHTML = resultDoubleRowMajor;

      }
    };
  </script>
  <script src="jacobi_solver.js"></script>
</body>

</html>
