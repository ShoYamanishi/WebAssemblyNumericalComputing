<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="main_style.css">
  <title>WebAssembly Numerical Computing: Prefix Sum</title>

</head>

<body>

  <main>
    <div class="description">
      <h1>WebAssembly Numerical Computing: Prefix Sum</h1>
      <p>
          This page measures the performance of prefix sum operation.
      </p>

      <p>
          The numbers below are in milliseconds.
          The time is sampled by <code>chrono::high_resolution_clock::now()</code>.
          Please note that the resolution of the function in most of the browsers is around <i>100 [μs]</i>,
          and therefore the value <i>0</i> below should be interpreted as somewhere between <i>0</i> and <i>100 [μs]</i>.
      </p>

    </div>
    <div class="tables">
      <h3>Results from This Browser</h3>
      <table id="results_browser" border="1">
      <th>Calculating...</th>
      </table>

      <h3>[Reference] Results from Mac Mini M1 2020 Native in C++</h3>
      <table class="results_native" border="1">

        <tr><th>vector length</th><th>32</th><th>128</th><th>512</th><th>2K</th><th>8K</th><th>32K</th><th>128K</th><th>512K</th><th>2M</th></tr>
        <tr><td>plain c++ loop unrolled order 1</td><td>7.761e-05</td><td>0.000175</td><td>0.00053707</td><td>0.00201332</td><td>0.00755751</td><td>0.0352363</td><td>0.0858382</td><td>0.19888</td><td>0.799492</td></tr>
        <tr><td>plain c++ loop unrolled order 2</td><td>7.791e-05</td><td>0.00018791</td><td>0.00058501</td><td>0.00240795</td><td>0.0104284</td><td>0.0267075</td><td>0.0702192</td><td>0.172809</td><td>0.702234</td></tr>
        <tr><td>plain c++ loop unrolled order 4</td><td>7.422e-05</td><td>0.00016127</td><td>0.00050797</td><td>0.00184957</td><td>0.00641376</td><td>0.0197612</td><td>0.0454458</td><td>0.124477</td><td>0.51995</td></tr>
        <tr><td>plain c++ loop unrolled order 8</td><td>8.875e-05</td><td>0.00022793</td><td>0.00079878</td><td>0.00250872</td><td>0.00913876</td><td>0.0296829</td><td>0.0658838</td><td>0.198891</td><td>0.814875</td></tr>
        <tr><td>std::inclusive_scan()</td><td>7.042e-05</td><td>0.00017498</td><td>0.00054501</td><td>0.00171125</td><td>0.00967956</td><td>0.0283788</td><td>0.0606284</td><td>0.205458</td><td>0.826698</td></tr>

      </table>

    </div>
  </main>

  <script>
    let Module = {
      onRuntimeInitialized: () => {

        let resultHTML = Module.testPrefixSum();
        console.log( resultHTML );
        
        let table = document.querySelector('#results_browser');
        table.innerHTML = resultHTML;
      }
    };
  </script>
  <script src="prefix_sum.js"></script>
</body>

</html>
